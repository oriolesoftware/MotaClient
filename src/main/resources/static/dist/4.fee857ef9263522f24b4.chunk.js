webpackJsonp([4],{131:function(e,t,o){e.exports={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"layout"},[n("Layout",{staticClass:"layout",nativeOn:{click:function(t){e.countdownReset()}}},[n("Header",{staticStyle:{padding:"20px"}},[n("Steps",{attrs:{current:0}},[n("Step",{attrs:{title:"进行中",content:"上传文件或插入U盘"}}),e._v(" "),n("Step",{attrs:{title:"待进行",content:"选择需要打印的文件"}}),e._v(" "),n("Step",{attrs:{title:"待进行",content:"调整打印设置"}}),e._v(" "),n("Step",{attrs:{title:"待进行",content:"选择打印方式"}}),e._v(" "),n("Step",{attrs:{title:"待进行",content:"设备打印"}})],1)],1),e._v(" "),n("Content",{staticStyle:{height:"100%",padding:"2%"},style:this.$root.background},[n("v-exception",{ref:"exceptionModel"}),e._v(" "),n("v-preProcessModel",{ref:"preProcessModel"}),e._v(" "),n("Modal",{attrs:{width:"360",closable:!1,"mask-closable":!1},model:{value:e.downloading,callback:function(t){e.downloading=t},expression:"downloading"}},[n("p",{staticStyle:{color:"#f60","text-align":"center"},attrs:{slot:"header"},slot:"header"},[n("Icon",{attrs:{type:"md-checkmark-circle-outline"}}),e._v(" "),n("span",[e._v("用户已上传文件")])],1),e._v(" "),n("div",{staticStyle:{"text-align":"center"}},[n("Spin",[n("Icon",{staticClass:"spin-icon-load",staticStyle:{margin:"10px"},attrs:{type:"ios-loading",size:"35"}}),e._v(" "),n("div",[e._v("正在等待终端接收文件")])],1)],1),e._v(" "),n("div",{staticStyle:{"text-align":"left"},attrs:{slot:"footer"},slot:"footer"},[n("p",[e._v("违反国家规定，出版、印刷、复制、发行非法出版物，所涉刑事与民事责任由内容提供者自行承担！为配合调查，墨拓将在公安机关介入时提供相关资料，请自重。")])])]),e._v(" "),n("Row",[n("p",{staticStyle:{"text-align":"center","font-size":"18px",color:"#000000"}},[e._v("MOTA校园 · 免费自助打印设备")]),e._v(" "),n("p",{staticStyle:{"text-align":"center","font-size":"40px",color:"#000000"}},[e._v("请扫描二维码或插入USB存储设备")])]),e._v(" "),n("Row",{staticStyle:{height:"80%"},attrs:{type:"flex",justify:"center"}},[n("Col",{attrs:{span:"3"}}),e._v(" "),n("Col",{staticStyle:{height:"100%","align-items":"center",display:"flex","flex-direction":"column","justify-content":"center"},attrs:{span:"9"}},[n("Card",{staticStyle:{"text-align":"center",width:"80%",margin:"5%"},attrs:{"dis-hover":""}},[n("p",{attrs:{slot:"title"},slot:"title"},[e._v("文件“码上”传")]),e._v(" "),n("p",[e._v("用户识别ID "+e._s(this.$root.randomCode))]),e._v(" "),n("div",{staticStyle:{"text-align":"center"}},[n("img",{ref:"QRCodeImg",attrs:{height:"150px"}}),e._v(" "),n("h3",[e._v("请使用 微信 或 QQ 扫描二维码上传文件")])]),e._v(" "),n("p",[e._v("您上传的文件将直接发送至终端，服务器不会保留您的文件")]),e._v(" "),e.loading_QR?n("Spin",{attrs:{fix:""}},[n("Icon",{staticClass:"spin-icon-load",attrs:{type:"ios-loading",size:"50"}}),e._v(" "),n("div",[e._v("加载二维码中")]),e._v(" "),n("div",[e._v("网络可能存在延迟，请稍等")])],1):e._e(),e._v(" "),e.scanned_QR?n("Spin",{attrs:{fix:""}},[n("Icon",{staticClass:"spin-icon-load",attrs:{type:"ios-loading",size:"50"}}),e._v(" "),n("div",[e._v("已扫描二维码")]),e._v(" "),n("div",[e._v("请尽快上传您的文件")])],1):e._e()],1)],1),e._v(" "),n("Col",{staticStyle:{height:"100%","align-items":"center",display:"flex","flex-direction":"column","justify-content":"center"},attrs:{span:"9"}},[n("div",{staticStyle:{"text-align":"center",width:"80%",margin:"5%"}},[n("img",{staticStyle:{margin:"5px"},attrs:{src:o(74),width:"200px"}}),e._v(" "),e.scanned_QR?e._e():n("Spin",{staticStyle:{margin:"10px"}},[n("Icon",{staticClass:"spin-icon-load",attrs:{type:"ios-loading",size:"35"}})],1),e._v(" "),e.scanned_QR?n("h2",{staticStyle:{color:"#2b85e4"}},[e._v("已扫描二维码，不可再插入USB设备")]):n("h2",[e._v("请插入USB移动存储设备")]),e._v(" "),n("p",{staticStyle:{"font-size":"14px"}},[e._v("插入后系统将自动识别处理您的设备"),n("br"),n("span",{staticStyle:{color:"#2b85e4"}},[e._v("（手机、随身听、录音笔等移动存储设备不可识别，若USB设备已插入，请重新插拔设备！）")])])],1)]),e._v(" "),n("Col",{attrs:{span:"3"}})],1)],1),e._v(" "),n("Footer",[n("p",{staticClass:"layout-footer-center"},[e._v("© Copyright 2018-2019 Oriole(MOTA). All Rights Reserved.")]),e._v(" "),n("v-countdownButton",{ref:"countdown",staticStyle:{position:"absolute",right:"10px",bottom:"10px"}})],1)],1)],1)},staticRenderFns:[]},e.exports.render._withStripped=!0},57:function(e,t,o){o(97);var n=o(14)(o(94),o(131),"data-v-5cf73673",null);n.options.__file="F:\\Projects\\IdeaProjects\\MotaControlView\\src\\views\\UploadFile.vue",n.esModule&&Object.keys(n.esModule).some(function(e){return"default"!==e&&"__esModule"!==e})&&console.error("named exports are not supported in *.vue files."),n.options.functional&&console.error("[vue-loader] UploadFile.vue: functional components are not supported with templates, they should use render functions."),e.exports=n.exports},58:function(e,t,o){o(62);var n=o(14)(o(59),o(66),"data-v-684d4a5f",null);n.options.__file="F:\\Projects\\IdeaProjects\\MotaControlView\\src\\components\\CountdownButton.vue",n.esModule&&Object.keys(n.esModule).some(function(e){return"default"!==e&&"__esModule"!==e})&&console.error("named exports are not supported in *.vue files."),n.options.functional&&console.error("[vue-loader] CountdownButton.vue: functional components are not supported with templates, they should use render functions."),e.exports=n.exports},59:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={data:function(){return{showButton:!0,router:"/"}},components:{},methods:{countDownStart:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:60,t=this,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"/",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"true";clearInterval(this.$root.countdownClock),this.router=o,this.showButton=n,this.$root.countdownReturnTime=e,this.$root.countdownClock=window.setInterval(function(){--t.$root.countdownReturnTime<0&&t.countdownDo()},1e3)},countdownDo:function(){clearInterval(this.$root.countdownClock),this.$router.push(this.router)},countdownReset:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:60;this.$root.countdownReturnTime=e}}}},60:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=o(58),s=o.n(n);t.default={components:{"v-countdownButton":s.a},data:function(){return{title:[{title:"执行结果",key:"state",width:90},{title:"代码",key:"code",width:90},{title:"异常信息",key:"msg"}],errorMsg:[],exceptionModel:!1,randomCode:null}},props:{},methods:{openExceptionModel:function(e,t){var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"-1",n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"ERROR";arguments[4]?this.$refs.countdown.countDownStart(60,"/StopServer"):this.$refs.countdown.countDownStart(60),this.randomCode=e;var s={};s.code=o,s.state=n,s.msg=t,this.errorMsg.push(s),this.exceptionModel=!0}}}},61:function(e,t){},62:function(e,t){},63:function(e,t,o){e.exports=o.p+"6f5a360e8c66765b60806e3babf78aef.png"},64:function(e,t,o){o(61);var n=o(14)(o(60),o(65),"data-v-0d3998ae",null);n.options.__file="F:\\Projects\\IdeaProjects\\MotaControlView\\src\\components\\ExceptionModel.vue",n.esModule&&Object.keys(n.esModule).some(function(e){return"default"!==e&&"__esModule"!==e})&&console.error("named exports are not supported in *.vue files."),n.options.functional&&console.error("[vue-loader] ExceptionModel.vue: functional components are not supported with templates, they should use render functions."),e.exports=n.exports},65:function(e,t,o){e.exports={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("Modal",{attrs:{width:"700",closable:!1,"mask-closable":!1},model:{value:e.exceptionModel,callback:function(t){e.exceptionModel=t},expression:"exceptionModel"}},[n("p",{staticStyle:{color:"#ed4014","text-align":"center"},attrs:{slot:"header"},slot:"header"},[n("Icon",{attrs:{type:"ios-information-circle"}}),e._v(" "),n("span",[e._v("系统发生错误或异常")])],1),e._v(" "),n("div",{staticStyle:{"text-align":"center"}},[n("img",{staticStyle:{margin:"10px"},attrs:{src:o(63),width:"200"}}),e._v(" "),n("p",{staticStyle:{"font-size":"16px"}},[e._v("由于设备发生致命错误，我们被迫终止本次打印服务，给您带来的不便我们深表歉意。")]),e._v(" "),n("p",{staticStyle:{color:"#999999"}},[e._v("若您已经付费，请保留下方随机用户码进行退费，您将在1个工作日内获得全额退款与一次免费打印机会（限20张内）")]),e._v(" "),n("p",{staticStyle:{margin:"5px"}},[e._v("随机用户编码："),n("span",{staticStyle:{"font-size":"22px"}},[e._v(e._s(e.randomCode)+"-ET")])])]),e._v(" "),n("div",{attrs:{slot:"footer"},slot:"footer"},[n("Table",{attrs:{columns:e.title,data:e.errorMsg}}),e._v(" "),n("v-countdownButton",{ref:"countdown",staticStyle:{"font-size":"16px","margin-top":"10px"}})],1)])},staticRenderFns:[]},e.exports.render._withStripped=!0},66:function(e,t,o){e.exports={render:function(){var e=this,t=e.$createElement,o=e._self._c||t;return e.showButton?o("Button",{staticStyle:{"font-size":"16px"},attrs:{type:"error"},on:{click:function(t){e.countdownDo()}}},[o("Icon",{attrs:{type:"md-exit"}}),e._v("\n    退出\n    "),o("span",{staticStyle:{color:"#FA8072"}},[e._v("["+e._s(this.$root.countdownReturnTime)+" 秒]")])],1):e._e()},staticRenderFns:[]},e.exports.render._withStripped=!0},67:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=o(15);o.n(n);t.default={data:function(){return{promptMessage:"海内存知己，天涯若比邻",promptMessageArray:["欢迎使用墨拓自助打印设备","来自中南大学计算机学院、商学院的8名同学","以梦为马，践行公益传媒","凡心所向，素履所往；生如逆旅，一苇以航"],fileProcessingModel:!1,processClock:0}},methods:{doAnimation:function(){var e=this,t=0;this.processClock=window.setInterval(function(){t++,e.promptMessage=e.promptMessageArray[t%e.promptMessageArray.length]},2e3)},fileProcessing:function(e,t,o){var s=this;this.doAnimation(),this.fileProcessingModel=!0,n({method:"get",url:"http://localhost:8999/preProcessing",params:{fileAbsolutePath:encodeURI(JSON.stringify(t)),fileType:o,randomCode:this.$root.randomCode}}).then(function(t){var o=t.data;"SUCCESS"==o.state?(console.log("Successful File Preprocessing"),clearInterval(s.processClock),s.$router.push({name:"SetPrintParam"})):(s.fileProcessingModel=!1,e.$refs.exceptionModel.openExceptionModel(s.$root.randomCode,o.msg,o.code,o.state))}).catch(function(t){s.fileProcessingModel=!1,e.$refs.exceptionModel.openExceptionModel(s.$root.randomCode,t.toString())})},copyFileProcessing:function(e,t){var o=this;this.doAnimation(),this.fileProcessingModel=!0,n({method:"get",url:"http://localhost:8999/copyPreProcessing",params:{totalPage:t,randomCode:this.$root.randomCode}}).then(function(t){var n=t.data;"SUCCESS"==n.state?(console.log("Successful File Preprocessing"),clearInterval(o.processClock),o.$router.push({name:"SetPrintParam"})):(o.fileProcessingModel=!1,e.$refs.exceptionModel.openExceptionModel(o.$root.randomCode,n.msg,n.code,n.state))}).catch(function(t){o.fileProcessingModel=!1,e.$refs.exceptionModel.openExceptionModel(o.$root.randomCode,t.toString())})}}}},68:function(e,t){},69:function(e,t,o){e.exports=o.p+"f082de95f3d1fd59c515b27d4aeafb2c.svg"},70:function(e,t,o){o(68);var n=o(14)(o(67),o(71),"data-v-0f0180d9",null);n.options.__file="F:\\Projects\\IdeaProjects\\MotaControlView\\src\\components\\PreProcessModel.vue",n.esModule&&Object.keys(n.esModule).some(function(e){return"default"!==e&&"__esModule"!==e})&&console.error("named exports are not supported in *.vue files."),n.options.functional&&console.error("[vue-loader] PreProcessModel.vue: functional components are not supported with templates, they should use render functions."),e.exports=n.exports},71:function(e,t,o){e.exports={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("Modal",{attrs:{width:"700",closable:!1,"mask-closable":!1},model:{value:e.fileProcessingModel,callback:function(t){e.fileProcessingModel=t},expression:"fileProcessingModel"}},[n("p",{staticStyle:{color:"#2b85e4","text-align":"center","font-size":"16px"},attrs:{slot:"header"},slot:"header"},[n("Icon",{attrs:{type:"ios-information-circle"}}),e._v(" "),n("span",[e._v("正在处理中，请稍后")])],1),e._v(" "),n("div",{staticStyle:{"text-align":"center"}},[n("iframe",{attrs:{frameborder:"0",scrolling:"no",src:"Loading",width:"100%",height:"150"}}),e._v(" "),n("p",{staticStyle:{"font-size":"16px"}},[e._v(e._s(e.promptMessage))]),e._v(" "),n("p",{staticStyle:{"font-size":"32px"}},[e._v("我们将很快完成")]),e._v(" "),n("p",{staticStyle:{"font-size":"16px"}},[e._v("为了确保文档格式与打印一致，小墨正在调用WPS Office2019处理相关文件")])]),e._v(" "),n("div",{attrs:{slot:"footer"},slot:"footer"},[n("img",{attrs:{src:o(69),width:"70px"}}),e._v(" "),n("p",[e._v("金山办公软件提供技术支持")])])])},staticRenderFns:[]},e.exports.render._withStripped=!0},74:function(e,t,o){e.exports=o.p+"6f55deaff33a8c2bdf3796ae5137efd5.gif"},94:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=o(15),s=(o.n(n),o(64)),i=o.n(s),r=o(58),c=o.n(r),a=o(70),l=o.n(a);t.default={components:{"v-exception":i.a,"v-countdownButton":c.a,"v-preProcessModel":l.a},data:function(){return{downloading:!1,scanned_QR:!1,loading_QR:!0,defeatNum:0,uploadedFilePath:[],uploadedFileType:null,usbListeningSource:{}}},mounted:function(){this.$refs.countdown.countDownStart(60),this.initWebSocket(),this.initListenUSBInsertion(),this.getQRCodePic()},methods:{countdownReset:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"120";this.$refs.countdown.countdownReset(e)},getQRCodePic:function(){var e=this;n({method:"get",url:this.$root.serverUrl+"file/getPrintFileUploadQRCode",responseType:"arraybuffer",params:{deviceID:this.$root.deviceID,randomCode:this.$root.randomCode}}).then(function(t){return e.loading_QR=!1,"data:image/png;base64,"+btoa(new Uint8Array(t.data).reduce(function(e,t){return e+String.fromCharCode(t)},""))}).then(function(t){e.$refs.QRCodeImg.src=t}).catch(function(t){e.$refs.exceptionModel.openExceptionModel(e.$root.randomCode,t.toString())})},initListenUSBInsertion:function(){var e=this;this.usbListeningSource=this.axios.CancelToken.source(),n({method:"get",url:"http://localhost:8999/listenUSBInsertion",cancelToken:this.usbListeningSource.token}).then(function(t){var o=t.data;"SUCCESS"==o.state&&(console.log("UBS Device Connection Successful"),e.$router.push({name:"ChooseFile",params:{roots:JSON.parse(o.msg)}}))}).catch(function(t){"Stop"!=t.message&&e.$refs.exceptionModel.openExceptionModel(e.$root.randomCode,t.toString())})},cancelListenUSBInsertion:function(){this.usbListeningSource.cancel("Stop")},initWebSocket:function(){var e=this.$root.websocketUrl+"webSocket/"+this.$root.randomCode;this.websock=new WebSocket(e),this.websock.onmessage=this.websocketOnMessage,this.websock.onopen=this.websocketOnOpen,this.websock.onerror=this.websocketOnError,this.websock.onclose=this.websocketClose},websocketOnOpen:function(){console.log("Successful establishment of WebSocket connection")},websocketOnError:function(e){if(this.defeatNum++,console.log("Failure to establish WebSocket connection,The reasons for the error are as follows:"),console.log(e),this.defeatNum<6){var t=this;"error"==e.type&&this.$Notice.error({title:"与服务器建立WEBSOCKET通讯失败",desc:"服务器未能响应请求，正在尝试重新连接 (第 "+this.defeatNum+" 次 / 共 5 次)，若依然失败，请联系MOTA官方 133-0535-6699 尝试解决此问题！"}),setTimeout(function(){t.initWebSocket()},5e3)}else this.$refs.exceptionModel.openExceptionModel(this.$root.randomCode,"Error: WebSocket连接没有正确建立")},websocketOnMessage:function(e){var t=JSON.parse(e.data);"SUCCESS"==t.state?"1"==t.code?(console.log("Successful Scanning QR Code"),this.scanned_QR=!0,this.cancelListenUSBInsertion(),this.countdownReset(300)):"2"==t.code&&this.downloadFile(t):this.$refs.exceptionModel.openExceptionModel(this.$root.randomCode,t.msg,t.code,t.state)},websocketSend:function(e){this.websock.send(e)},websocketClose:function(e){this.websock.close(),console.log("WebSocket Connection Disconnected",e)},downloadFile:function(e){var t=this;console.log("Successful Uploading File"),this.downloading=!0,n({method:"get",url:"http://localhost:8999/download",params:{fileName:e.msg,randomCode:this.$root.randomCode}}).then(function(e){var o=e.data;if("SUCCESS"==o.state){var n=JSON.parse(o.msg);t.downloading=!1,t.uploadedFilePath.push(n.filePath),t.uploadedFileType=n.fileType,console.log("Successful Downloading File"),t.$refs.preProcessModel.fileProcessing(t,t.uploadedFilePath,t.uploadedFileType)}else t.$refs.exceptionModel.openExceptionModel(t.$root.randomCode,o.msg,o.code,o.state)}).catch(function(e){t.$refs.exceptionModel.openExceptionModel(t.$root.randomCode,e.toString())})}}}},97:function(e,t){}});